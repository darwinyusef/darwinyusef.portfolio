---
import { getLangFromUrl} from "../i18n/utils";
const lang = getLangFromUrl(Astro.url);
import UpcomingEvents from "../components/UpcomingEvents.astro";

// Cargar proyectos desde JSON
const response = await fetch(new URL('/data/projects.json', Astro.url.origin));
const projects = await response.json();
const activeProjects = projects.filter((p: any) => p.is_active);
---

<div class="max-w-[1400px] mx-auto">
  <div class="text-center mb-12">
    <h2
      class="text-4xl md:text-5xl font-black mb-4"
      style="font-family: 'Inter Tight', system-ui, sans-serif;"
    >
      {
        lang === "es"
          ? "Galería de Proyectos"
          : lang === "en"
            ? "Project Gallery"
            : "Galeria de Projetos"
      }
    </h2>
    <p class="text-xl text-gray-400 max-w-2xl mx-auto">
      {
        lang === "es"
          ? "Una muestra visual de algunos de mis trabajos y creaciones"
          : lang === "en"
            ? "A visual sample of some of my works and creations"
            : "Uma amostra visual de alguns dos meus trabalhos e criações."
      }
    </p>
  </div>

  <!-- Masonry Grid -->
  <div class="masonry-grid">
    {activeProjects.map((project: any) => (
      <div
        class="masonry-item cursor-hover-target"
        data-cursor-text={lang === "es"
          ? "Ver proyecto"
          : lang === "en"
            ? "View project"
            : "Ver projeto"}
      >
        <div class="masonry-card">
          <img
            src={project.image}
            alt={project.alt}
            class="w-full h-auto rounded-2xl"
          />
          <div class="masonry-overlay">
            <h3 class="text-2xl font-bold mb-2">
              {typeof project.title === 'object' ? project.title[lang] : project.title}
            </h3>
            <p class="/90">
              {project.description[lang]}
            </p>
          </div>
        </div>
      </div>
    ))}
  </div>
</div>

<style>

  /* Masonry Gallery */
  .masonry-grid {
    column-count: 1;
    column-gap: 1.5rem;
  }

  @media (min-width: 640px) {
    .masonry-grid {
      column-count: 2;
    }
  }

  @media (min-width: 1024px) {
    .masonry-grid {
      column-count: 3;
    }
  }

  .masonry-item {
    break-inside: avoid;
    margin-bottom: 1.5rem;
    display: inline-block;
    width: 100%;
  }

  .masonry-card {
    position: relative;
    overflow: hidden;
    border-radius: 1rem;
    transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .masonry-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
  }

  .masonry-card img {
    display: block;
    width: 100%;
    height: auto;
    transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .masonry-card:hover img {
    transform: scale(1.05);
  }

  .masonry-overlay {
    position: absolute;
    margin-top: 20px;
    bottom: 0;
    left: 0;
    right: 0;
    color: white;
    font-weight: bold;
    padding: 2rem;
    transform: translateY(100%);
    background: rgba(0, 0, 0, 0.8) !important;
    transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .masonry-card:hover .masonry-overlay {
    transform: translateY(0);
    background: #000000 !important;
  }

</style>
