---
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import { getLangFromUrl, useTranslations } from "../i18n/utils";
import { getCollection } from "astro:content";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const podcastsFromContent = await getCollection("podcasts", ({ data }) => data.is_active);
---

<Layout title={t("podcast.title")}>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

  <div class="min-h-screen bg-[#0a0a0a]">
    <Header />

    <main class="overflow-hidden px-5">
      <!-- Hero Section con Ultra Large Text -->
      <section class="relative min-h-[70vh] flex items-center justify-center py-20">
        <div class="max-w-[1800px] mx-auto w-full">
          <div class="text-center">
            <h1 class="text-[clamp(3rem,12vw,12rem)] font-black leading-[0.9] tracking-tighter  mb-8" style="font-family: 'Inter Tight', system-ui, sans-serif;">
              {lang === 'es' ? 'MI' : lang === 'en' ? 'MY' : 'MEU'}
              <br />
              <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary via-purple-600 to-pink-600">
                PODCAST
              </span>
            </h1>
            <p class="text-xl md:text-2xl text-gray-400 max-w-3xl mx-auto leading-relaxed" style="font-family: 'Inter Tight', system-ui, sans-serif;">
              {lang === 'es'
                ? 'Conversaciones sobre tecnolog√≠a, desarrollo y experiencias en el mundo tech.'
                : lang === 'en'
                ? 'Conversations about technology, development and experiences in the tech world.'
                : 'Conversas sobre tecnologia, desenvolvimento e experi√™ncias no mundo tech.'}
            </p>
          </div>
        </div>
      </section>

      <!-- Parallax Inspiration Banner -->
      <section class="py-32 relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-b from-transparent via-pink-600/5 to-transparent pb-16"></div>

        <!-- Elementos flotantes de fondo con parallax -->
        <div class="parallax-bg absolute inset-0 pointer-events-none">
          <div class="parallax-element absolute top-20 left-10 w-72 h-72 bg-pink-600/10 rounded-full blur-3xl" data-speed="0.3"></div>
          <div class="parallax-element absolute bottom-20 right-10 w-96 h-96 bg-primary/10 rounded-full blur-3xl" data-speed="0.5"></div>
          <div class="parallax-element absolute top-1/2 left-1/4 w-64 h-64 bg-purple-600/10 rounded-full blur-3xl" data-speed="0.4"></div>
        </div>

        <div class="max-w-[1400px] mx-auto relative z-10 px-6">
          <!-- Contenedor centrado -->
          <div class="flex flex-col items-center justify-center text-center space-y-16">

            <!-- Mascota con efecto parallax -->
            <div class="parallax-mascot-podcast relative" data-speed="0.2">
              <div class="absolute inset-0 bg-gradient-to-br from-pink-600/20 via-primary/20 to-purple-600/20 rounded-full blur-3xl scale-150 animate-pulse"></div>
              <img
                src="/img/mascota2.png"
                alt="Podcast Mascot"
                class="relative w-80 md:w-96 lg:w-[450px] xl:w-[500px] h-auto drop- transform hover:scale-105 transition-transform duration-500"
              />
            </div>

            <!-- Contenido centrado -->
            <div class="max-w-4xl space-y-10">
              <div class="parallax-quote-podcast" data-speed="0.1">
                <blockquote class="text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-black leading-tight" style="font-family: 'Inter Tight', system-ui, sans-serif;">
                  <span class="inline-block bg-gradient-to-r from-pink-600 via-primary to-purple-600 bg-clip-text text-transparent">
                    {lang === 'es' ? 'Escucha' : lang === 'en' ? 'Listen' : 'Ou√ßa'}
                  </span>
                  <br/>
                  <span class="inline-block bg-gradient-to-r from-purple-600 via-pink-600 to-primary bg-clip-text text-transparent">
                    {lang === 'es' ? 'Datos Reales' : lang === 'en' ? 'Real Datas' : 'Hist√≥rias Reais'}
                  </span>
                  <br/>
                <span class="inline-block text-white">
                  {lang === 'es'
                    ? 'para la comunidad TI'
                    : lang === 'en'
                    ? 'for the tech community'
                    : 'para a comunidade de TI'}
                </span>
                </blockquote>
              </div>

              <div class="parallax-description-podcast" data-speed="0.15">
                <p class="text-xl md:text-2xl text-gray-400 leading-relaxed max-w-3xl mx-auto">
                  {lang === 'es'
                    ? 'Conversaciones profundas con personas que se mueven en el √°mbito de la tecnolog√≠a y comparten sus experiencias, desaf√≠os superados y lecciones aprendidas en su camino profesional.'
                    : lang === 'en'
                    ? 'Deep conversations with people active in the technology space who share their experiences, challenges overcome, and lessons learned throughout their professional journey.'
                    : 'Conversas profundas com pessoas que atuam no universo da tecnologia e compartilham suas experi√™ncias, desafios superados e li√ß√µes aprendidas ao longo de sua trajet√≥ria profissional.'}
                </p>
              </div>

              <!-- Podcast Features -->
              <div class="parallax-podcast-features grid grid-cols-3 gap-6 max-w-2xl mx-auto mt-12" data-speed="0.2">
                <div class="text-center p-4 rounded-xl bg-gray-800/50 backdrop-blur-sm border">
                  <div class="text-4xl mb-2">üéôÔ∏è</div>
                  <div class="text-sm text-white font-semibold ">{lang === 'es' ? 'Audio HD' : lang === 'en' ? 'HD Audio' : '√Åudio HD'}</div>
                </div>
                <div class="text-center p-4 rounded-xl bg-gray-800/50 backdrop-blur-sm border">
                  <div class="text-4xl mb-2">üí°</div>
                  <div class="text-sm text-white font-semibold ">{lang === 'es' ? 'Insights' : lang === 'en' ? 'Insights' : 'Insights'}</div>
                </div>
                <div class="text-center p-4 rounded-xl bg-gray-800/50 backdrop-blur-sm border">
                  <div class="text-4xl mb-2">‚è±Ô∏è</div>
                  <div class="text-sm text-white font-semibold ">{lang === 'es' ? 'Episodios' : lang === 'en' ? 'Episodes' : 'Epis√≥dios'}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Latest Episode Featured -->
      <section class="pb-16 max-w-7xl mx-auto relative z-10">
        {podcastsFromContent.length > 0 && (
          <div class="mb-16">
            <div class="flex items-center gap-3 mb-8">
              <span class="material-symbols-outlined text-whitetext-4xl text-blue-400">star</span>
              <h2 class="text-3xl font-bold ">
                {lang === 'es' ? 'Episodio Destacado' : lang === 'en' ? 'Featured Episode' : 'Epis√≥dio Destacado'}
              </h2>
              <span class="px-3 py-1 bg-gradient-to-r from-primary to-purple-600  text-sm font-bold rounded-full">
                {lang === 'es' ? 'NUEVO' : lang === 'en' ? 'NEW' : 'NOVO'}
              </span>
            </div>

            {(() => {
              const latestPodcast = podcastsFromContent.sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())[0];
              return (
                <article class="podcast-card-featured group relative overflow-hidden rounded-3xl bg-gradient-to-br from-[#1a1a2e] to-[#16213e]  border-2 border-purple-900/50 hover:shadow-purple-500/30 transition-all duration-500">
                  <div class="grid md:grid-cols-2 gap-0">
                    <!-- Image Section -->
                    <div class="relative h-80 md:h-auto overflow-hidden">
                      {latestPodcast.data.coverImage ? (
                        <img
                          src={latestPodcast.data.coverImage}
                          alt={latestPodcast.data.title}
                          class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"
                        />
                      ) : (
                        <div class="w-full h-full bg-gradient-to-br from-primary via-purple-600 to-pink-600 flex items-center justify-center">
                          <span class="material-symbols-outlined text-white" style="font-size: 10rem; opacity: 0.3;">podcast</span>
                        </div>
                      )}
                      <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div>

                      <!-- Play Button Overlay -->
                      <button
                        class="play-podcast-btn absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-24 h-24 rounded-full bg-white/90 dark:bg-black/90 backdrop-blur-sm flex items-center justify-center  hover:scale-110 transition-all duration-300 group/play z-10"
                        data-audio={latestPodcast.data.audioUrl}
                        data-title={latestPodcast.data.title}
                      >
                        <span class="material-symbols-outlined text-whitetext-blue-400 text-6xl group-hover/play:scale-110 transition-transform">play_circle</span>
                      </button>

                      <!-- Duration Badge -->
                      <div class="absolute bottom-6 right-6 bg-black/80 backdrop-blur-sm  px-4 py-2 rounded-full font-bold flex items-center gap-2">
                        <span class="material-symbols-outlined text-whitetext-sm">schedule</span>
                        {latestPodcast.data.duration}
                      </div>
                    </div>

                    <!-- Content Section -->
                    <div class="p-8 md:p-10 flex flex-col justify-center">
                      <div class="flex items-center gap-2 mb-4">
                        <span class="px-3 py-1 bg-gradient-to-r from-red-500 to-pink-500  text-xs font-bold rounded-full uppercase">En vivo</span>
                        <span class="text-sm text-gray-500 dark:text-gray-400">
                          {new Date(latestPodcast.data.pubDate).toLocaleDateString(lang === 'es' ? 'es-ES' : lang === 'en' ? 'en-US' : 'pt-BR', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                          })}
                        </span>
                      </div>

                      <h3 class="text-4xl md:text-5xl font-black  mb-6 leading-tight" style="font-family: 'Inter Tight', system-ui, sans-serif;">
                        {latestPodcast.data.title}
                      </h3>

                      <p class="text-lg text-gray-300 mb-8 leading-relaxed">
                        {latestPodcast.data.description}
                      </p>

                      <div class="flex flex-wrap gap-4">
                        <a
                          href={lang === "es" ? `/podcast/${latestPodcast.slug}` : `/${lang}/podcast/${latestPodcast.slug}`}
                          class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-primary to-purple-600  rounded-xl font-bold text-lg transition-all duration-300 hover:shadow-xl hover:scale-105 group/btn"
                        >
                          <span>{lang === 'es' ? 'Ver Episodio Completo' : lang === 'en' ? 'Watch Full Episode' : 'Ver Epis√≥dio Completo'}</span>
                          <span class="material-symbols-outlined text-whitegroup-hover/btn:translate-x-1 transition-transform">arrow_forward</span>
                        </a>
                      </div>
                    </div>
                  </div>
                </article>
              );
            })()}
          </div>
        )}

        <!-- Separator -->
        {podcastsFromContent.length > 1 && (
          <div class="relative mb-12">
            <div class="absolute inset-0 flex items-center">
              <div class="w-full border-t-2 border-gray-700"></div>
            </div>
            <div class="relative flex justify-center">
              <span class="bg-[#0a0a0a] px-6 py-2 text-sm font-semibold text-gray-500 dark:text-gray-400 rounded-full border-2 border-gray-700">
                {lang === 'es' ? 'Todos los episodios' : lang === 'en' ? 'All episodes' : 'Todos os epis√≥dios'}
              </span>
            </div>
          </div>
        )}

        <!-- All Episodes Grid -->
        <div id="podcast-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {
            podcastsFromContent.length > 0 ? (
              podcastsFromContent
                .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())
                .slice(1) // Skip first (featured)
                .map((podcast, index) => (
                  <article class="podcast-card group relative overflow-hidden rounded-2xl bg-[#1a1a1a] shadow-lg transition-all duration-500 hover:-translate-y-2 border border-gray-800">
                    <!-- Cover Image -->
                    <div class="relative h-32 overflow-hidden">
                      {podcast.data.coverImage ? (
                        <img
                          src={podcast.data.coverImage}
                          alt={podcast.data.title}
                          class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"
                        />
                      ) : (
                        <div class="w-full h-full bg-gradient-to-br from-primary to-purple-600 flex items-center justify-center">
                          <span class="material-symbols-outlined text-white text-6xl opacity-30">podcast</span>
                        </div>
                      )}
                      <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent"></div>

                      <!-- Author Badge -->
                      <div class="absolute top-3 left-3 flex items-center gap-2 bg-white/95 dark:bg-black/95 backdrop-blur-sm px-3 py-1.5 rounded-full shadow-lg">
                        <div class="w-6 h-6 rounded-full bg-gradient-to-br from-pink-600 to-primary flex items-center justify-center">
                          <span class="material-symbols-outlined text-white text-xs">person</span>
                        </div>
                        <span class="text-xs font-semibold ">Yusef Gonz√°lez</span>
                      </div>

                      <!-- Play Button -->
                      <button
                        class="play-podcast-btn absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-14 h-14 rounded-full bg-white/95 dark:bg-black/95 backdrop-blur-sm flex items-center justify-center shadow-xl hover:scale-110 transition-all duration-300 opacity-0 group-hover:opacity-100"
                        data-audio={podcast.data.audioUrl}
                        data-title={podcast.data.title}
                      >
                        <span class="material-symbols-outlined text-whitetext-blue-400 text-4xl">play_arrow</span>
                      </button>

                      <!-- Duration -->
                      <div class="absolute bottom-3 right-3 bg-black/80 backdrop-blur-sm  px-2.5 py-1 rounded-full text-xs font-bold flex items-center gap-1">
                        <span class="material-symbols-outlined text-whitetext-xs">schedule</span>
                        {podcast.data.duration}
                      </div>
                    </div>

                    <!-- Content -->
                    <div class="p-5">
                      <div class="text-xs text-gray-500 dark:text-gray-400 mb-2 font-medium flex items-center gap-1">
                        <span class="material-symbols-outlined text-whitetext-xs">calendar_today</span>
                        {new Date(podcast.data.pubDate).toLocaleDateString(lang === 'es' ? 'es-ES' : lang === 'en' ? 'en-US' : 'pt-BR', {
                          year: 'numeric',
                          month: 'short',
                          day: 'numeric'
                        })}
                      </div>

                      <h3 class="font-bold text-lg  mb-4 leading-tight line-clamp-2 group-hover:text-blue-400 transition-colors" style="font-family: 'Inter Tight', system-ui, sans-serif;">
                        {podcast.data.title}
                      </h3>

                      <div class="flex items-center gap-2">
                        <a
                          href={lang === "es" ? `/podcast/${podcast.slug}` : `/${lang}/podcast/${podcast.slug}`}
                          class="flex-1 inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-pink-600 to-primary  rounded-xl font-semibold text-sm transition-all duration-300 hover:shadow-lg hover:scale-105"
                        >
                          <span class="material-symbols-outlined text-whitetext-base">headphones</span>
                          <span>{lang === 'es' ? 'Escuchar' : lang === 'en' ? 'Listen' : 'Ouvir'}</span>
                        </a>
                      </div>
                    </div>
                  </article>
                ))
            ) : (
              <div class="col-span-full text-center py-8">
                <p class="text-gray-400">
                  {lang === 'es' ? 'No hay episodios disponibles en este momento.' : lang === 'en' ? 'No episodes available at this time.' : 'Nenhum epis√≥dio dispon√≠vel no momento.'}
                </p>
              </div>
            )
          }
        </div>
      </section>
    </main>
  </div>

  <!-- Enhanced Audio Player -->
  <div
    id="audio-player"
    class="fixed bottom-0 left-0 right-0 bg-gradient-to-r from-[#1a1a2e] to-[#16213e] border-t-2 border-purple-900/50 backdrop-blur-xl  hidden z-50"
  >
    <div class="max-w-7xl mx-auto px-6 py-5">
      <div class="flex items-center gap-6">
        <!-- Play/Pause Button -->
        <button
          id="play-pause-btn"
          class="flex h-14 w-14 items-center justify-center rounded-full bg-gradient-to-r from-primary to-purple-600  hover:scale-110 transition-all duration-300 shadow-lg hover:shadow-xl flex-shrink-0"
        >
          <span class="material-symbols-outlined text-white text-3xl" id="play-pause-icon">play_arrow</span>
        </button>

        <!-- Track Info & Progress -->
        <div class="flex-1 min-w-0">
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-3 min-w-0 flex-1">
              <span class="material-symbols-outlined text-whitetext-blue-400 text-2xl flex-shrink-0">podcast</span>
              <div class="min-w-0 flex-1">
                <div class="text-base font-bold  truncate" id="current-title">
                  T√≠tulo del episodio
                </div>
                <div class="text-xs text-gray-500 dark:text-gray-400">
                  {lang === 'es' ? 'Reproduciendo ahora' : lang === 'en' ? 'Now playing' : 'Reproduzindo agora'}
                </div>
              </div>
            </div>

            <!-- Close Button -->
            <button
              id="close-player-btn"
              class="ml-4 h-10 w-10 flex items-center justify-center rounded-full hover:bg-gray-200 dark:hover:bg-gray-800 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-all duration-300 flex-shrink-0"
            >
              <span class="material-symbols-outlined">close</span>
            </button>
          </div>

          <!-- Progress Bar -->
          <div class="flex items-center gap-3">
            <span class="text-xs font-semibold text-gray-400 w-12 text-right" id="current-time">0:00</span>
            <div
              class="flex-1 h-2 bg-gray-700 rounded-full overflow-hidden cursor-pointer group"
              id="progress-bar"
            >
              <div class="h-2 bg-gradient-to-r from-primary to-purple-600 rounded-full transition-all duration-100 group-hover:h-3" id="progress" style="width: 0%"></div>
            </div>
            <span class="text-xs font-semibold text-gray-400 w-12" id="duration-time">0:00</span>
          </div>
        </div>
      </div>
    </div>

    <audio id="audio-element" preload="metadata"></audio>
  </div>
</Layout>

<script>
  let currentAudio: HTMLAudioElement | null = null;
  let isPlaying = false;

  function formatTime(seconds: number): string {
    const mins = Math.floor(seconds / 60);
    const secs = Math.floor(seconds % 60);
    return `${mins}:${secs.toString().padStart(2, "0")}`;
  }

  function playPodcast(audioUrl: string, title: string) {
    console.log('üé¨ playPodcast llamada con:', { audioUrl, title });

    const audioElement = document.getElementById(
      "audio-element"
    ) as HTMLAudioElement;
    const audioPlayer = document.getElementById("audio-player");
    const currentTitle = document.getElementById("current-title");
    const playPauseIcon = document.getElementById("play-pause-icon");

    console.log('üîç Elementos encontrados:', {
      audioElement: !!audioElement,
      audioPlayer: !!audioPlayer,
      currentTitle: !!currentTitle,
      playPauseIcon: !!playPauseIcon
    });

    if (!audioElement || !audioPlayer || !currentTitle || !playPauseIcon) {
      console.error('‚ùå Faltan elementos necesarios para reproducir');
      return;
    }

    if (currentAudio && currentAudio.src.includes(audioUrl)) {
      console.log('üîÑ Mismo audio, alternar play/pause');
      if (isPlaying) {
        audioElement.pause();
        playPauseIcon.textContent = "play_arrow";
        isPlaying = false;
        console.log('‚è∏Ô∏è Audio pausado');
      } else {
        audioElement.play().then(() => {
          console.log('‚ñ∂Ô∏è Audio reanudado');
        }).catch(err => {
          console.error('‚ùå Error al reproducir:', err);
        });
        playPauseIcon.textContent = "pause";
        isPlaying = true;
      }
    } else {
      console.log('üÜï Nuevo audio, configurando...');
      audioElement.src = audioUrl;
      currentTitle.textContent = title;
      audioElement.play().then(() => {
        console.log('‚úÖ Audio iniciado correctamente');
      }).catch(err => {
        console.error('‚ùå Error al iniciar audio:', err);
      });
      playPauseIcon.textContent = "pause";
      isPlaying = true;
      audioPlayer.classList.remove("hidden");
      console.log('üëÅÔ∏è Reproductor mostrado');
    }

    currentAudio = audioElement;
  }

  document.addEventListener("DOMContentLoaded", () => {
    const audioElement = document.getElementById(
      "audio-element"
    ) as HTMLAudioElement;
    const playPauseBtn = document.getElementById("play-pause-btn");
    const playPauseIcon = document.getElementById("play-pause-icon");
    const closePlayerBtn = document.getElementById("close-player-btn");
    const progressBar = document.getElementById("progress-bar");
    const progress = document.getElementById("progress");
    const currentTime = document.getElementById("current-time");
    const durationTime = document.getElementById("duration-time");
    const audioPlayer = document.getElementById("audio-player");

    // Event listeners para los botones de reproducci√≥n
    console.log('üéß Inicializando reproductores de podcast...');
    const playButtons = document.querySelectorAll(".play-podcast-btn");
    console.log(`üìª Encontrados ${playButtons.length} botones de reproducci√≥n`);

    playButtons.forEach((btn, index) => {
      const audioUrl = (btn as HTMLElement).dataset.audio || "";
      const title = (btn as HTMLElement).dataset.title || "";
      console.log(`üéµ Bot√≥n ${index + 1}: "${title}" -> ${audioUrl}`);

      btn.addEventListener("click", (e) => {
        e.preventDefault();
        e.stopPropagation();
        const target = e.currentTarget as HTMLButtonElement;
        const url = target.dataset.audio || "";
        const podcastTitle = target.dataset.title || "";
        console.log('‚ñ∂Ô∏è Click en reproducir:', podcastTitle);
        console.log('üîó URL del audio:', url);
        playPodcast(url, podcastTitle);
      });
    });

    // Trigger animations despu√©s de registrar los event listeners
    setTimeout(() => {
      document.querySelectorAll('.podcast-card, .podcast-card-featured').forEach((card, index) => {
        setTimeout(() => {
          card.classList.add('fade-in-up');
        }, index * 100);
      });
    }, 10);

    if (
      audioElement &&
      playPauseBtn &&
      playPauseIcon &&
      closePlayerBtn &&
      progressBar &&
      progress &&
      currentTime &&
      durationTime &&
      audioPlayer
    ) {
      playPauseBtn.addEventListener("click", () => {
        if (isPlaying) {
          audioElement.pause();
          playPauseIcon.textContent = "play_arrow";
          isPlaying = false;
        } else {
          audioElement.play();
          playPauseIcon.textContent = "pause";
          isPlaying = true;
        }
      });

      closePlayerBtn.addEventListener("click", () => {
        audioElement.pause();
        audioElement.src = "";
        audioPlayer.classList.add("hidden");
        isPlaying = false;
        playPauseIcon.textContent = "play_arrow";
      });

      audioElement.addEventListener("timeupdate", () => {
        const percent =
          (audioElement.currentTime / audioElement.duration) * 100;
        progress.style.width = `${percent}%`;
        currentTime.textContent = formatTime(audioElement.currentTime);
      });

      audioElement.addEventListener("loadedmetadata", () => {
        durationTime.textContent = formatTime(audioElement.duration);
      });

      progressBar.addEventListener("click", (e) => {
        const rect = progressBar.getBoundingClientRect();
        const percent = (e.clientX - rect.left) / rect.width;
        audioElement.currentTime = percent * audioElement.duration;
      });
    }
  });

  // Parallax scroll effect
  function initParallax() {
    const parallaxElements = document.querySelectorAll(
      ".parallax-mascot-podcast, .parallax-quote-podcast, .parallax-description-podcast, .parallax-podcast-features"
    );

    if (parallaxElements.length === 0) return;

    let ticking = false;

    function updateParallax() {
      parallaxElements.forEach((element) => {
        const speed = parseFloat(element.getAttribute("data-speed") || "0.5");
        const rect = element.getBoundingClientRect();
        const elementTop = rect.top;
        const elementHeight = rect.height;
        const windowHeight = window.innerHeight;

        // Only apply parallax when element is in viewport
        if (elementTop < windowHeight && elementTop + elementHeight > 0) {
          const scrolled = windowHeight - elementTop;
          const parallax = scrolled * speed;
          element.style.transform = `translateY(${parallax}px)`;
        }
      });

      ticking = false;
    }

    function requestTick() {
      if (!ticking) {
        requestAnimationFrame(updateParallax);
        ticking = true;
      }
    }

    window.addEventListener("scroll", requestTick, { passive: true });
    updateParallax(); // Initial call
  }

  // Initialize parallax on page load
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initParallax);
  } else {
    initParallax();
  }
</script>

<style>
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .fade-in-up {
    animation: fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }

  .hero-content {
    animation: fadeInUp 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }

  .podcast-card {
    opacity: 0;
    transform: translateY(30px);
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 12px;
  }

  ::-webkit-scrollbar-track {
    background: #F8F8F8;
  }

  :root.dark ::-webkit-scrollbar-track {
    background: #0a0a0a;
  }

  ::-webkit-scrollbar-thumb {
    background: linear-gradient(to bottom, var(--primary-color), #9333ea);
    border-radius: 6px;
    border: 2px solid #F8F8F8;
  }

  :root.dark ::-webkit-scrollbar-thumb {
    border-color: #0a0a0a;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(to bottom, #9333ea, var(--primary-color));
  }

  #podcast-container {
    animation: fadeInUp 1s cubic-bezier(0.16, 1, 0.3, 1) 0.4s backwards;
  }
</style>
